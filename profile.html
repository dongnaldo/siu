<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>프로필</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; text-align: center; }
    #profileImage {
      width: 90%; max-width: 360px; border-radius: 20px; margin-top: 25px;
    }
    #homeBtn {
      margin-top: 30px;
      padding: 10px 18px;
      border: none;
      border-radius: 8px;
      background-color: #007bff;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h2 id="profileTitle">프로필</h2>
  <img id="profileImage" src="" alt="Profile Image">
  <div>
    <button id="homeBtn">홈으로</button>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script>
    // Firebase 설정 (index.html과 동일해야 함)
    const firebaseConfig = {
      apiKey: "...",
      authDomain: "...",
      projectId: "...",
      storageBucket: "...",
      messagingSenderId: "...",
      appId: "...",
      measurementId: "..."
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // URL 쿼리에서 uid 가져오기
    const params = new URLSearchParams(window.location.search);
    const viewUid = params.get("uid");  // 예: ?uid=abcdef123

    // 기본 이미지 (uid 기반 사진 없을 경우)
    const defaultImage = "profile-bg-1.png";

    // Elements
    const profileImage = document.getElementById("profileImage");
    const profileTitle = document.getElementById("profileTitle");
    const homeBtn = document.getElementById("homeBtn");

    // 홈으로 돌아가기
    homeBtn.addEventListener("click", () => {
      window.location.href = "index.html";
    });

    // 로그인 상태 확인 → 그리고 프로필 보여주기
    auth.onAuthStateChanged(user => {
      let isMe = false;
      if (user && viewUid && user.uid === viewUid) {
        isMe = true;
      }

      if (viewUid) {
        // 유저의 프로필 사진 파일명을 uid로 가정
        // 예: images/profiles/UID.jpg 또는 .png
        // 만약 Firebase Storage 연동했다면 fetch URL 또는 signed URL 써야 함
        profileImage.src = `images/profiles/${viewUid}.png`;
      } else {
        // uid 파라미터 없으면 기본 이미지
        profileImage.src = defaultImage;
      }

      if (isMe) {
        profileTitle.innerText = "내 프로필";
      } else {
        profileTitle.innerText = "사용자 프로필";
      }
    });
  </script>
</body>
</html>
